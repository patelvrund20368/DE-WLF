<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Show My Location</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link rel="stylesheet" href="../static/organization.css" />
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <!-- <script src="script.js"></script> -->
</head>

<body>
  <!-- Header -->

  <header>
    <nav class="navbar">
        <div class="logo">
    <a href="#" id="previous-arrow">&#8249;</a>
            <img src="https://i.ibb.co/hfZtrzg/logo1-removebg-preview.png" alt="Logo">
        </div>
        <a href="#" class="toggle-button">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </a>
        <div class="navbar-links">
            <ul>
                
                <li><a href="../templates/organization.html">Organization</a></li>
                <li><a href="../templates/precautions.html">Precautions</a></li>
                <li><a href="../templates/emergency.html">Emergency&nbsp;kit</a></li>
                <li>
                    <div class="dropdown">
                        <a href="#" class="dropdown-btn">&#9776;</a>
                        <div class="dropdown-content" id="myDropdown">
                            <a class="dropdown-item" href="../templates/Blog.html">Blog</a>
                            <a class="dropdown-item" href="../templates/gallery.html">Gallery</a>
                            <a class="dropdown-item" href="../templates/about-us.html">About Us</a>
                        </div>
                    </div>
                </li>
                

            </ul>
        </div>
    </nav>

</header>

  <!-- Main body -->
  <main>
    <div class="org-name"></div>
    <h1 class="organization-name">Organization Name</h1>
    </div>
    <section id="about-body">
      <div class="Site-content">
        <div class="map-container">
          <div class="user-info">

            <div class="info">
              <p>User: <span>&#160;Dhara Savani</span></p>
              <p>Contact No: +91-9820398233</p>
              <div id="distance">Distance: Calculating...</div>
              <button class="accept-button">Accept</button>
              <button class="decline-button" style="margin-left: 11%" onclick="removeInfo(this)">
                Decline
              </button>
              <br /><br />
              <hr />
              <hr />
              <br />
            </div>

            <div class="info">
              <p>User: <span>&#160;Vrund Patel</span></p>
              <p>Contact No: +91-9820398233</p>
              <div id="distance">Distance: Calculating...</div>
              <button class="accept-button">Accept</button>
              <button class="decline-button" style="margin-left: 11%" onclick="removeInfo(this)">
                Decline
              </button>
              <br /><br />
              <hr />
              <hr />
              <br />
            </div>

            <div class="info">
              <p>User: <span>&#160;Parth Patel</span></p>
              <p>Contact No: +91-9820398233</p>
              <div id="distance">Distance: Calculating...</div>
              <button class="accept-button">Accept</button>
              <button class="decline-button" style="margin-left: 11%" onclick="removeInfo(this)">
                Decline
              </button>
              <br /><br />
              <hr />
              <hr />
            </div>

          </div>
          <div id="map"></div>
        </div>
        <button id="user-location" onclick="displayInfo()">Rescue</button>
        <br />
        <br />
        <button id="organization-location">Show My Location</button>
      </div>
    </section>


    <div class="rescue-track-container">

      <div>
        <h3 style="font-size: 130%">
          Number of Animals and Birds rescued by you
        </h3>
      </div>

      <div class="rescue-data">
        <div class="data">
          <p class="num">72</p>
          <p class="d1" style="color: #6746c1">Animal Rescued</p>
        </div>
        <div class="data">
          <p class="num">78</p>
          <p class="d2" style="color: #e6653c">Birds Rescued</p>
        </div>
      </div>

    </div>


  </main>

  <!-- Footer -->
  <footer>
    <div class= "footer">
      <div>
        <img id="logo-footer" src="https://i.ibb.co/LSX9KgQ/logo1.png" />
      </div>
      
      <div class="footer-list">
        <div></div>
        <div class="footer-li">
          <ul id="learn-more"><b>Learn More</b>
            <div class="f-data">
              <li><a class="footer-a" href="../templates/homepage.html">Home</a></li>                        
              <li><a class="footer-a" href="../templates/precautions.html">Precautions</a></li>
              <li><a class="footer-a" href="../templates/emergency.html">Emergency Kit</a></li>
              <li><a class="footer-a" href="#">Reviews</a></li>
            </div>
          </ul>
        </div>
  
        <div class="footer-li">
          <ul id="Company"><b>Company</b>
            <div class="f-data">
              <li><a class="footer-a" href="../templates/about-us.html">About Us</a></li>                        
              <li><a class="footer-a" href="../templates/gallery.html">Gallery</a></li>
              <li><a class="footer-a" href="../templates/Blog.html">Blogs</a></li>
              <li><a class="footer-a" href="../templates/organization.html">Organizations</a></li>
            </div>
          </ul>
        </div>
  
        <div class="footer-li">
          <ul id="support"><b>Support</b>
            <div class="f-data">
              <li><a class="footer-a" style="font-size: 17px;" >(+91) 9537300286</a></li>
              <li><a class="footer-a" href="#">Contact Us</a></li>
              <li><a class="footer-a" href="#">FAQ</a></li>
            </div>
          </ul>
        </div>
          
      </div>
    </div>
  </footer>
  <script>
    var backButton = document.getElementById('previous-arrow');
    backButton.addEventListener("click", function () {
      window.history.back();
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const toggleButton = document.querySelector('.toggle-button');
      const navbarLinks = document.querySelector('.navbar-links');

      toggleButton.addEventListener('click', () => {
        // navbarLinks.classList.toggle('active');
        toggleButton.classList.toggle('cross');
      });
    });
  </script>

  <script>
    // Initialize the map
    var map = L.map("map").setView([0, 0], 13);

    // Add an OpenStreetMap tile layer
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      subdomains: "abc",
    }).addTo(map);

    var markers = L.featureGroup().addTo(map);
    var acceptButtons = document.getElementsByClassName("accept-button");

    Array.from(acceptButtons).forEach(function (button) {
      button.addEventListener("click", function () {
        if (navigator.geolocation) {
          // Prompt the user for location access
          navigator.geolocation.getCurrentPosition(
            (position) => {
              // Get the user's location
              const userLocation = {
                lat: position.coords.latitude,
                lng: position.coords.longitude,
              };

              var marker = L.marker([
                userLocation.lat,
                userLocation.lng,
              ]).addTo(markers);

              var infoDiv = button.closest('.info');
              var name = infoDiv.querySelector('span').textContent;
              console.log(name);
              var popupContent =
                `<strong>User Information:</strong><br>Name: ${name}<br>Email: wildliferescue@wlf.com<br>Phone No: +91 9283819331`;
              marker.bindPopup(popupContent).openPopup();
              markers.addTo(map);
              map.fitBounds(markers.getBounds());

              // Center the map on the user's location
              map.setView(userLocation, 13);

              // Add a marker at the user's location (optional)
              L.marker(userLocation).addTo(map);
            },
            (error) => {
              console.error("Location access denied:", error);
            }
          );
        } else {
          console.error("Geolocation not supported by your browser.");
        }
      });
    });
    // document.getElementsByClassName("accept-button").addEventListener("click", () => {

    // });
  </script>
  <script>
    function displayInfo() {
      var userInfos = document.querySelectorAll(".info");
      console.log(userInfos);
      userInfos.forEach(function (info) {
        info.classList.toggle("visible");
      });

    }

    function removeInfo(button) {
      var removeInfo = button.closest(".info");
      var userName = removeInfo.querySelector('span').textContent;

      markers.eachLayer(function (layer) {
        if (layer._popup.getContent().includes(userName)) {
          map.removeLayer(layer);
          // map.setView([0, 0], 13);
        }
      });

      // removeInfo.style.display = 'none';
      removeInfo.remove();

      var userInfos = document.querySelectorAll(".info");
      if (userInfos.length === 0) {
        //   markers.clearLayers();
        //   map.closePopup();
        map.setView([0, 0], 13);
      }
    }
  </script>
  <script>
    var backButton = document.getElementById('previous-arrow');
    backButton.addEventListener("click", function () {
      window.history.back();
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const toggleButton = document.querySelector('.toggle-button');
      const navbarLinks = document.querySelector('.navbar-links');

      toggleButton.addEventListener('click', () => {
        navbarLinks.classList.toggle('active');
      });
    });
  </script>
</body>

</html>